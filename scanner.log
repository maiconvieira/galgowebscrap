2025-11-02 13:23:19,020 - MainThread - INFO - Mapa de pistas 'data/mapa_pistas.json' carregado.
2025-11-02 13:23:19,021 - MainThread - INFO - Verificando e criando tabelas (se não existirem)...
2025-11-02 13:23:22,016 - MainThread - INFO - Banco de dados verificado com sucesso.
2025-11-02 13:23:22,017 - MainThread - INFO - ### === INICIANDO CICLO ETL DIÁRIO PARA 2025-11-02 === ###
2025-11-02 13:23:22,017 - MainThread - INFO - ### INICIANDO ETL COMPLETO PARA A DATA: 2025-11-02 ###
2025-11-02 13:23:22,017 - MainThread - INFO - Cache JSON (TF e GH) encontrado para 2025-11-02. Pulando Extração (Scraping).
2025-11-02 13:23:22,018 - MainThread - INFO - Iniciando Processamento (T & L) para 2025-11-02...
2025-11-02 13:23:22,018 - MainThread - INFO - Iniciando ETL (Processamento T & L) para a data: 2025-11-02
2025-11-02 13:23:22,040 - MainThread - INFO - Carregados 100 registros do arquivo TF.
2025-11-02 13:23:22,068 - MainThread - INFO - Carregados 132 registros do arquivo GH.
2025-11-02 13:23:22,068 - MainThread - INFO - Iniciando mesclagem dos dados TF e GH...
2025-11-02 13:23:22,076 - MainThread - WARNING - 1 corridas do TF não encontraram correspondência em GH.
2025-11-02 13:23:22,076 - MainThread - WARNING - 51 corridas do GH não encontraram correspondência em TF.
2025-11-02 13:23:22,076 - MainThread - INFO - Mesclagem concluída. Total de 99 corridas para processar.
2025-11-02 13:23:22,209 - MainThread - INFO - Arquivo de debug 1 (bruto mesclado) salvo em: data/2025-11-02_debug_1_mesclado_bruto.json
2025-11-02 13:23:22,209 - MainThread - INFO - Aplicando filtros de ML (Categoria e Distância) em 99 corridas...
2025-11-02 13:23:22,209 - MainThread - INFO - Filtragem concluída. 37 corridas são elegíveis para o ML.
2025-11-02 13:23:22,209 - MainThread - WARNING -   -> 29 corridas descartadas por distância (fora de 300m-700m).
2025-11-02 13:23:22,209 - MainThread - WARNING -   -> 62 corridas descartadas por categoria (fora de {'A6', 'A3', 'A8', 'A2', 'A7', 'A5', 'A4', 'A9'}).
2025-11-02 13:23:22,209 - MainThread - INFO - Iniciando limpeza e validação de 37 corridas...
2025-11-02 13:23:22,292 - MainThread - INFO - Arquivo de debug 2 (limpo/pydantic) salvo em: data/2025-11-02_debug_2_reorganizado_limpo.json
2025-11-02 13:23:22,292 - MainThread - INFO - Iniciando salvamento de 37 corridas no banco de dados...
2025-11-02 13:23:22,292 - MainThread - WARNING - Limpando dados existentes para a data 2025-11-02 antes da inserção...
2025-11-02 13:23:22,558 - MainThread - INFO - 0 corridas (e seus participantes/históricos) deletadas para 2025-11-02.
2025-11-02 13:28:03,024 - MainThread - INFO - Dados salvos no banco com sucesso (commit realizado).
2025-11-02 13:28:03,024 - MainThread - INFO - Sessão do banco fechada.
2025-11-02 13:28:03,031 - MainThread - INFO - Processamento para 2025-11-02 concluído.
2025-11-02 13:28:03,031 - MainThread - INFO - ### === CICLO ETL DIÁRIO PARA 2025-11-02 CONCLUÍDO === ###
